<div class="container" *ngIf="perfil">
    <header class="nav">
        <div class="nav__user">
            <app-routing-btn style="cursor: pointer;" *ngIf="!perfil.me"></app-routing-btn>
            <h2>{{ perfil.usuario }}</h2>
        </div>
        <div class="nav__options">
            <button class="options__btn" style="color: var(--rojo)" *ngIf="perfil.me" (click)="mostrarAvisoLogOut = true">
                <svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M17 16L21 12M21 12L17 8M21 12L7 12M13 16V17C13 18.6569 11.6569 20 10 20H6C4.34315 20 3 18.6569 3 17V7C3 5.34315 4.34315 4 6 4H10C11.6569 4 13 5.34315 13 7V8" stroke="var(--rojo)" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg>
            </button>
        </div>
    </header>
    <div class="userInfo">
        <div style="position: relative;">
            <img class="userInfo__pic" [src]="perfil.foto ? perfil.foto : './../../assets/img/noPic.webp'">
        </div>
        <div class="userInfo__info">
            <p class="info__name">{{ perfil.nombre }}</p>
            <div class="info__follows">
                <div class="follows__btn">
                    <span>{{ perfil.posts.length }}</span>
                    <p>publicaciones</p>
                </div>
                <div class="follows__btn">
                    <span>{{ perfil.seguidores }}</span>
                    <p>seguidores</p>
                </div>
                <div class="follows__btn">
                    <span>{{ perfil.seguidos }}</span>
                    <p>siguiendo</p>
                </div>
            </div>
        </div>
    </div>
    <p class="descripcion" [innerHTML]="descripcionFinal"></p>
    <div class="userOptions">
        <button *ngIf="perfil.me" class="userOptions__btn userOptions__btn--large" (click)="mostrarEditar = true">Editar</button>
        <button *ngIf="perfil.me" class="userOptions__btn userOptions__btn--large" (click)="mostrarQR = true">Compartir</button>
        <button *ngIf="!perfil.me && !siguiendo" (click)="seguir()" class="userOptions__btn userOptions__btn--large userOptions__btn--color">Seguir</button>
        <button *ngIf="!perfil.me && siguiendo" (click)="seguir()" class="userOptions__btn userOptions__btn--large">Siguiendo</button>
        <button *ngIf="!perfil.me" class="userOptions__btn userOptions__btn--large" (click)="crearChat()">Mensaje</button>
    </div>

    <div class="links">
        <span class="links__link" (click)="mostrarPosts = true"><svg version="1.0" xmlns="http://www.w3.org/2000/svg"
            width="24" height="24" viewBox="0 0 512.000000 512.000000"
            preserveAspectRatio="xMidYMid meet">
    
            <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"
            fill="#000000" stroke="none">
            <path d="M0 4335 l0 -785 785 0 785 0 0 785 0 785 -785 0 -785 0 0 -785z"/>
            <path d="M1870 4335 l0 -785 690 0 690 0 0 785 0 785 -690 0 -690 0 0 -785z"/>
            <path d="M3550 4335 l0 -785 785 0 785 0 0 785 0 785 -785 0 -785 0 0 -785z"/>
            <path d="M0 2560 l0 -690 785 0 785 0 0 690 0 690 -785 0 -785 0 0 -690z"/>
            <path d="M1870 2560 l0 -690 690 0 690 0 0 690 0 690 -690 0 -690 0 0 -690z"/>
            <path d="M3550 2560 l0 -690 785 0 785 0 0 690 0 690 -785 0 -785 0 0 -690z"/>
            <path d="M0 785 l0 -785 785 0 785 0 0 785 0 785 -785 0 -785 0 0 -785z"/>
            <path d="M1870 785 l0 -785 690 0 690 0 0 785 0 785 -690 0 -690 0 0 -785z"/>
            <path d="M3550 785 l0 -785 785 0 785 0 0 785 0 785 -785 0 -785 0 0 -785z"/>
            </g>
        </svg></span>
        <span class="links__link" (click)="mostrarPosts = false">
            <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 122.14 122.88" style="enable-background:new 0 0 122.14 122.88" xml:space="preserve"><g><path d="M35.14,0H87c9.65,0,18.43,3.96,24.8,10.32c6.38,6.37,10.34,15.16,10.34,24.82v52.61c0,9.64-3.96,18.42-10.32,24.79 l-0.02,0.02c-6.38,6.37-15.16,10.32-24.79,10.32H35.14c-9.66,0-18.45-3.96-24.82-10.32l-0.24-0.27C3.86,105.95,0,97.27,0,87.74 V35.14c0-9.67,3.95-18.45,10.32-24.82S25.47,0,35.14,0L35.14,0z M91.51,31.02l0.07,0.11h21.6c-0.87-5.68-3.58-10.78-7.48-14.69 C100.9,11.64,94.28,8.66,87,8.66h-8.87L91.51,31.02L91.51,31.02z M81.52,31.13L68.07,8.66H38.57l13.61,22.47H81.52L81.52,31.13z M42.11,31.13L28.95,9.39c-4.81,1.16-9.12,3.65-12.51,7.05c-3.9,3.9-6.6,9.01-7.48,14.69H42.11L42.11,31.13z M113.48,39.79H8.66 v47.96c0,7.17,2.89,13.7,7.56,18.48l0.22,0.21c4.8,4.8,11.43,7.79,18.7,7.79H87c7.28,0,13.9-2.98,18.69-7.77l0.02-0.02 c4.79-4.79,7.77-11.41,7.77-18.69V39.79L113.48,39.79z M50.95,54.95l26.83,17.45c0.43,0.28,0.82,0.64,1.13,1.08 c1.22,1.77,0.77,4.2-1,5.42L51.19,94.67c-0.67,0.55-1.53,0.88-2.48,0.88c-2.16,0-3.91-1.75-3.91-3.91V58.15h0.02 c0-0.77,0.23-1.55,0.7-2.23C46.76,54.15,49.19,53.72,50.95,54.95L50.95,54.95L50.95,54.95z"/></g></svg>
        </span>
    </div>
    <app-edit-profile *ngIf="mostrarEditar" [perfil]="perfil" (cerrarEditar)="mostrarEditar = false"></app-edit-profile>
    
    <app-user-posts *ngIf="mostrarPosts" [posts]="perfil.posts"></app-user-posts>
    <app-user-reels *ngIf="!mostrarPosts" [reels]="perfil.posts"></app-user-reels>
    <div class="compartirPerfil" *ngIf="mostrarQR">
        <span (click)="mostrarQR = false" class="compartirPerfil__salir">
            <svg fill="currentColor" height="28" width="28" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                viewBox="0 0 460.775 460.775" xml:space="preserve">
            <path d="M285.08,230.397L456.218,59.27c6.076-6.077,6.076-15.911,0-21.986L423.511,4.565c-2.913-2.911-6.866-4.55-10.992-4.55
                c-4.127,0-8.08,1.639-10.993,4.55l-171.138,171.14L59.25,4.565c-2.913-2.911-6.866-4.55-10.993-4.55
                c-4.126,0-8.08,1.639-10.992,4.55L4.558,37.284c-6.077,6.075-6.077,15.909,0,21.986l171.138,171.128L4.575,401.505
                c-6.074,6.077-6.074,15.911,0,21.986l32.709,32.719c2.911,2.911,6.865,4.55,10.992,4.55c4.127,0,8.08-1.639,10.994-4.55
                l171.117-171.12l171.118,171.12c2.913,2.911,6.866,4.55,10.993,4.55c4.128,0,8.081-1.639,10.992-4.55l32.709-32.719
                c6.074-6.075,6.074-15.909,0-21.986L285.08,230.397z"/>
            </svg>
        </span>
        <p style="font-weight: 700; color: white; font-size: 24px;">Comparte tu perfil</p>
        <p style="color: white; font-size: 18px; text-align: center; padding-inline: 20px;">Con el QR todos los que lo escaneen accederán a tu perfil al momento</p>
        <div style="background-color: white; padding: 20px; border-radius: 10px;">
            <img [src]="codigoQR">
        </div>
    </div>
</div>

<div class="avisoLogOut" *ngIf="mostrarAvisoLogOut">
    <div class="avisoLogOut__panel">
        <p style="color: var(--text); font-weight: bold; margin-top: 10px; font-size: 18px;">¿Quieres cerrar sesión?</p>
        <p style="color: var(--text); font-size: 15px; margin-top: 10px;">Se redirigirá a la página de iniciar sesión</p>
        <div class="panel__botones">
            <button class="panel__boton" style="color: var(--rojo);" (click)="cerrarSesion()">Cerrar sesión</button>
            <button class="panel__boton" style="color: var(--azul);" (click)="mostrarAvisoLogOut = false">Cancelar</button>
        </div>
    </div>
</div>

<app-loading-screen [texto]="'Cargando chat...'" *ngIf="loader"></app-loading-screen>
<app-msgmodal *ngIf="modal" [duracion]="2000" [texto]="'Error al cargar el chat'" (cerrarModal)="modal = false"></app-msgmodal>